var EcommerceOrders = function () {

    var initPickers = function () {
        //init date pickers
        $('.date-picker').datepicker({
            rtl: Metronic.isRTL(),
            autoclose: true
        });
    }

    var handleOrders = function (table_name) {
    	
        var grid = new Datatable();
        
        $.extend(true, $.fn.DataTable.TableTools.classes, {
            "container": "btn-group tabletools-dropdown-on-portlet",
            "buttons": {
                "normal": "btn btn-sm default",
                "disabled": "btn btn-sm default disabled"
            },
            "collection": {
                "container": "DTTT_dropdown dropdown-menu tabletools-dropdown-menu"
            }
        });

        grid.init({
            src: $(table_name),
            onSuccess: function (grid) {
                // execute some code after table records loaded
            },
            onError: function (grid) {
                // execute some code on network or other general error  
            },
            dataTable: { // here you can define a typical datatable settings from http://datatables.net/usage/options 
                "lengthMenu": [
                    [20, 50, 100, 150, -1],
                    [20, 50, 100, 150, "All"] // change per page values here
                ],
                "pageLength": 20, // default record count per page
                "ajax": {
                    "url": "/orders/orderList.sc"  // ajax source
                	
                },
//                "order": [
//                          [2, "desc"]
//                      ], // set first column as a default sort by asc
                
                //"dom": "<'row'<'col-md-8 col-sm-12'pli><'col-md-4 col-sm-12'<'table-group-actions pull-right'>>r><'table-scrollable't><'row'<'col-md-8 col-sm-12'pli><'col-md-4 col-sm-12'>>", // datatable layout
                "dom":"<'row'<'col-md-8 col-sm-12'l><'col-md-4 col-sm-12'<'table-group-actions pull-right'>>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>",
                
                
//                "tableTools": {
//                    "sSwfPath": "../../assets/global/plugins/datatables/extensions/TableTools/swf/copy_csv_xls_pdf.swf",
//                    "aButtons": [
//     	                        "copy",
//     	                        {
//     	                        	
//     	                        	"sExtends": "print",
//     		                        "sButtonText": "Print",
//     		                        "sInfo": 'Please press "CTR+P" to print or "ESC" to quit',
//     		                        "sMessage": "Generated by DataTables"
//     	                        	
//     	                        },
//     	                        {
//     	                            "sExtends":    "collection",
//     	                            "sButtonText": "Save",
//     	                            "aButtons":    [ "csv", "xls", "pdf" ]
//     	                        }
//     	                    ]
                
                
//                    "aButtons": [{
//                        "sExtends": "pdf",
//                        "sButtonText": "PDF"
//                    }, {
//                        "sExtends": "csv",
//                        "sButtonText": "CSV"
//                    }, {
//                        "sExtends": "xls",
//                        "sButtonText": "Excel"
//                    }, {
//                        "sExtends": "print",
//                        "sButtonText": "Print",
//                        "sInfo": 'Please press "CTRL+P" to print or "ESC" to quit',
//                        "sMessage": "Generated by DataTables"
//                    }, {
//                        "sExtends": "copy",
//                        "sButtonText": "Copy"
//                    }]
//                }
                
                
            }
        });
        
        var tableWrapper = $(table_name+'_wrapper'); // datatable creates the table wrapper by adding with id {your_table_jd}_wrapper
        tableWrapper.find('.dataTables_length select').select2(); // initialize select2 dropdown

        // handle group actionsubmit button click
        grid.getTableWrapper().on('click', '.table-group-action-submit', function (e) {
            e.preventDefault();
            var action = $(".table-group-action-input", grid.getTableWrapper());
            if (action.val() != "" && grid.getSelectedRowsCount() > 0) {
                grid.setAjaxParam("customActionType", "group_action");
                grid.setAjaxParam("customActionName", action.val());
                grid.setAjaxParam("id", grid.getSelectedRows());
                grid.getDataTable().ajax.reload();
                grid.clearAjaxParams();
            } else if (action.val() == "") {
                Metronic.alert({
                    type: 'danger',
                    icon: 'warning',
                    message: 'Please select an action',
                    container: grid.getTableWrapper(),
                    place: 'prepend'
                });
            } else if (grid.getSelectedRowsCount() === 0) {
                Metronic.alert({
                    type: 'danger',
                    icon: 'warning',
                    message: 'No record selected',
                    container: grid.getTableWrapper(),
                    place: 'prepend'
                });
            }
        });

    }

    return {

        //main function to initiate the module
        init: function (table_name) {

            initPickers();
            handleOrders(table_name);
        }

    };

}();